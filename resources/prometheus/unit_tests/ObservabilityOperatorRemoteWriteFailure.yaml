rule_files:
  - /tmp/prometheus-rules-test.yaml
  - /tmp/recording-rules-test.yaml

evaluation_interval: 1m
tests:
  - interval: 1m
    input_series:
      - series: prometheus_remote_storage_succeeded_samples_total{namespace="rhacs-observability"}
        values: "1+100x30 3000+10x150"
      - series: prometheus_remote_storage_samples_in_total{namespace="rhacs-observability"}
        values: "1+100x180"
    alert_rule_test:
      - eval_time: 60m
        alertname: ObservabilityOperatorRemoteWriteFailure
        exp_alerts: []
      - eval_time: 160m
        alertname: ObservabilityOperatorRemoteWriteFailure
        exp_alerts:
          - exp_labels:
              severity: critical
            exp_annotations:
              summary: "The Observability Operator's Prometheus is failing to remote write to Observatorium."
              description: "The Prometheus remote write success rate is `10%`."
              sop_url: ""
